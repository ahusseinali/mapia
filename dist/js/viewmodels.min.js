var app=app||{};app.viewModels=app.viewModels||{},app.mapObjects=app.mapObjects||{},function(){"use strict";ko.bindingHandlers.googlemap={init:function(e,p){var a=p().map,o={zoom:a.zoom(),center:a.center(),styles:a.styles(),mapTypeControl:!1};app.mapObjects.map=new google.maps.Map(e,o),app.mapObjects.infowindow=new google.maps.InfoWindow({content:""}),app.mapObjects.infowindow.addListener("closeclick",function(){var e=this.getContent();e&&(e=e.firstChild,$("#infoboxTemplate").append(e),this.setContent("")),this.close()}),app.mapObjects.markers=[];var t=a.places;t.loadGooglePlaces(a.center())},update:function(e,p){var a=p().map,o=p().info,t=a.places;app.mapObjects.markers.forEach(function(e){e.setMap(null)}),app.mapObjects.markers=[],app.mapObjects.infoboxName=o,t.selectedPlaces().forEach(function(e){var p=new google.maps.Marker({position:e.latLng,map:app.mapObjects.map});p.setIcon("img/"+e.types[0]+".png"),google.maps.event.clearListeners(p,"click"),p.addListener("click",function(){a.closeSideNav(),t.loadYelpDetails(e),t.currentPlace(e);var o=$('<div id="'+app.mapObjects.infoboxName+'"></div>').append($("#infoContainer"));app.mapObjects.infowindow.setContent(o[0]),app.mapObjects.infowindow.open(app.mapObjects.map,p)}),app.mapObjects.markers.push(p)})}};var e=function(e){this.mapModel=ko.observable(e)};e.prototype.search=function(e){new google.maps.event.trigger(app.mapObjects.infowindow,"closeclick"),this.mapModel().search(e)},e.prototype.selectPlace=function(e){new google.maps.event.trigger(app.mapObjects.markers[e],"click")},app.viewModels.mapVM=new e(app.models.mapModel)}();